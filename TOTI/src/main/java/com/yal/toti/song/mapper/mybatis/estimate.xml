<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yal.toti.song.mentor.dao.EstimateDao">

	<resultMap type="com.yal.toti.song.mentor.domain.Coin" id="coin">
		<result column="mento_idx" property="mento_idx" />
		<result column="tor_coin" property="tor_coin" />
	</resultMap>
	<!-- 견적서 등록 -->
	<insert id="insertEstimate"
		parameterType="com.yal.toti.song.mentor.domain.EstimateInfo">
		insert into toti_estimatee (request_idx, mento_idx, est_price, est_cont,
		est_file)
		values (#{request_idx},#{mento_idx},#{est_price},#{est_cont},#{est_file});
	</insert>

	<update id="updateCoin"
		parameterType="com.yal.toti.song.mentor.domain.EstimateInfo">
		update toti.toti_mentor set tor_coin = (tor_coin - 1) where mento_idx 
		= #{mento_idx} and tor_coin>=1
	</update>

	<!-- 코인 체크 -->
	<select id="coinCheck" resultMap="coin">
		select mento_idx, tor_coin from toti.toti_mentor where mento_idx = #{mento_idx}
	</select>
</mapper>