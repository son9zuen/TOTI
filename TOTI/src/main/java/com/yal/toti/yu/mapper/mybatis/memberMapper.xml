<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- interface의 full name을 namespace의 속성으로 사용 : 필수 -->
<mapper namespace="com.yal.toti.yu.member.dao.MemberDaoInterface">

	<resultMap id="memberMap"
		type="com.yal.toti.yu.member.domain.MemberInfo">
		
		<result property="id" column="m_id" />
		<result property="idx" column="m_idx" />
		<result property="pw" column="m_pw" />
		<result property="name" column="m_name" />
		<result property="ver" column="m_ver" />
		<result property="gender" column="m_gender" />
		<result property="photo_name" column="m_photo" />
		<result property="regDate" column="m_date" />
		<result property="verify" column="m_codeVer" />
		<result property="code" column="m_code" />
	</resultMap> 

	<resultMap type="com.yal.toti.yu.member.domain.MentorInfo" id="mentorMap">
	
		<result property="m_idx" column="mento_idx"/>
		<result property="coin" column="tor_coin"/>
		<result property="location" column="tor_location"/>
	
	</resultMap>
	
	<insert id="insertMen" parameterType="com.yal.toti.yu.member.domain.MentorInfo">
	
	insert into toti_mentor (mento_idx, tor_coin, tor_location) values
	(#{m_idx},#{coin},#{location})
	
	</insert>
	
	<!-- 회원가입 -->
	<insert id="insertMem"
		parameterType="com.yal.toti.yu.member.domain.MemberInfo">
		
		insert into toti_member (m_id, m_name, m_pw, m_ver, m_gender,m_date, m_code) 
		  values
		(#{id},#{name},#{pw},#{ver},#{gender},#{regDate},#{code})
		
	</insert>
	
	
	<!-- 회원로그인 -->
	<select id="selectById" resultMap="memberMap">
		select * from toti_member where m_id = #{id}
	</select>
	<!-- 인증 -->
	<update id="updateVerify">
	update toti_member set m_codeVer = 'Y' where m_id = #{id}
	</update>

	<!-- 수정 -->
	<update id="updateMem" parameterType="com.yal.toti.yu.member.domain.MemberInfo">
		update toti_member set
			<if test="photo_name == null">
			m_pw = #{pw}, m_ver = #{ver} where m_id = #{id}
			</if>
			<if test="photo_name != null">
			m_photo = #{photo_name} where m_id = #{id}
			</if>
	</update>

	<!-- verChange  -->
	<update id="verUpdate"
		parameterType="com.yal.toti.yu.member.domain.MemberInfo">
		update toti_member set m_ver=#{ver} where m_id=#{id}
	</update>

	
	<!-- 탈퇴 -->
	<delete id="deleteMem">
		delete from toti_member where m_id = #{id}
	</delete>
</mapper>